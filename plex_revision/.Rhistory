scale_colour_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
#facet_grid(cols = vars(genotype)) +
ylab("expression in log2 RPKM") +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5), legend.position = "none") -> expression_germline_line
expression_germline_line
germline_summary %>%
ggplot(aes(stage, median, colour = genotype, group = genotype)) +
geom_ribbon(aes(ymin = median - st_dev, ymax = median + st_dev), fill = "grey") +
geom_line() +
scale_colour_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
#facet_grid(cols = vars(genotype)) +
ylab("expression in log2 RPKM") +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5), legend.position = "none") -> expression_germline_line
expression_germline_line
germline_summary %>%
ggplot(aes(stage, median, colour = genotype, group = genotype)) +
geom_ribbon(aes(ymin = median - st_dev, ymax = median + st_dev, fill = genotype),) +
geom_line() +
scale_colour_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
scale_fill_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour), alpha = 20) +
#facet_grid(cols = vars(genotype)) +
ylab("expression in log2 RPKM") +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5), legend.position = "none") -> expression_germline_line
germline_summary %>%
ggplot(aes(stage, median, colour = genotype, group = genotype)) +
geom_ribbon(aes(ymin = median - st_dev, ymax = median + st_dev, fill = genotype),) +
geom_line() +
scale_colour_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
scale_fill_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
#facet_grid(cols = vars(genotype)) +
ylab("expression in log2 RPKM") +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5), legend.position = "none") -> expression_germline_line
expression_germline_line
germline_summary %>%
ggplot(aes(stage, median, colour = genotype, group = genotype)) +
#geom_ribbon(aes(ymin = median - st_dev, ymax = median + st_dev, fill = genotype),) +
geom_line() +
scale_colour_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
scale_fill_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
#facet_grid(cols = vars(genotype)) +
ylab("expression in log2 RPKM") +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5), legend.position = "none") -> expression_germline_line
expression_germline_line
germline_summary %>%
ggplot(aes(stage, median, colour = genotype, group = genotype)) +
#geom_ribbon(aes(ymin = median - st_dev, ymax = median + st_dev, fill = genotype),) +
geom_line(size = 3) +
scale_colour_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
scale_fill_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
#facet_grid(cols = vars(genotype)) +
ylab("expression in log2 RPKM") +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5), legend.position = "none") -> expression_germline_line
expression_germline_line
germline_summary %>%
ggplot(aes(stage, median, colour = genotype, group = genotype)) +
geom_ribbon(aes(ymin = median - st_dev, ymax = median + st_dev, fill = genotype, alpha = 20),) +
geom_line(size = 3) +
scale_colour_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
scale_fill_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
#facet_grid(cols = vars(genotype)) +
ylab("expression in log2 RPKM") +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5), legend.position = "none") -> expression_germline_line
expression_germline_line
germline_summary %>%
ggplot(aes(stage, median, colour = genotype, group = genotype)) +
geom_ribbon(aes(ymin = median - st_dev, ymax = median + st_dev, fill = genotype, alpha = 5),) +
geom_line(size = 3) +
scale_colour_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
scale_fill_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
#facet_grid(cols = vars(genotype)) +
ylab("expression in log2 RPKM") +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5), legend.position = "none") -> expression_germline_line
expression_germline_line
germline_summary %>%
ggplot(aes(stage, median, colour = genotype, group = genotype)) +
geom_ribbon(aes(ymin = median - st_dev, ymax = median + st_dev, fill = genotype, alpha = 2),) +
geom_line(size = 3) +
scale_colour_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
scale_fill_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
#facet_grid(cols = vars(genotype)) +
ylab("expression in log2 RPKM") +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5), legend.position = "none") -> expression_germline_line
expression_germline_line
germline_summary %>%
ggplot(aes(stage, median, colour = genotype, group = genotype)) +
geom_ribbon(aes(ymin = median - st_dev, ymax = median + st_dev, fill = genotype, alpha = 0.5),) +
geom_line(size = 3) +
scale_colour_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
scale_fill_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
#facet_grid(cols = vars(genotype)) +
ylab("expression in log2 RPKM") +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5), legend.position = "none") -> expression_germline_line
expression_germline_line
germline_summary %>%
ggplot(aes(stage, median, colour = genotype, group = genotype)) +
geom_ribbon(aes(ymin = median - st_dev, ymax = median + st_dev, fill = genotype, alpha = 80),) +
geom_line(size = 3) +
scale_colour_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
scale_fill_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
#facet_grid(cols = vars(genotype)) +
ylab("expression in log2 RPKM") +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5), legend.position = "none") -> expression_germline_line
expression_germline_line
germline_summary %>%
ggplot(aes(stage, median, colour = genotype, group = genotype)) +
geom_ribbon(aes(ymin = median - st_dev, ymax = median + st_dev, fill = genotype),) +
geom_line(size = 3) +
scale_colour_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
scale_fill_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
#facet_grid(cols = vars(genotype)) +
ylab("expression in log2 RPKM") +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5), legend.position = "none") -> expression_germline_line
expression_germline_line
germline_summary %>%
ggplot(aes(stage, median, colour = genotype, group = genotype)) +
geom_ribbon(aes(ymin = median - st_dev, ymax = median + st_dev, fill = genotype),alpha = 10) +
geom_line(size = 3) +
scale_colour_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
scale_fill_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
#facet_grid(cols = vars(genotype)) +
ylab("expression in log2 RPKM") +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5), legend.position = "none") -> expression_germline_line
expression_germline_line
germline_summary %>%
ggplot(aes(stage, median, colour = genotype, group = genotype)) +
geom_ribbon(aes(ymin = median - st_dev, ymax = median + st_dev, fill = genotype),alpha = 80) +
geom_line(size = 3) +
scale_colour_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
scale_fill_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
#facet_grid(cols = vars(genotype)) +
ylab("expression in log2 RPKM") +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5), legend.position = "none") -> expression_germline_line
expression_germline_line
germline_summary %>%
ggplot(aes(stage, median, colour = genotype, group = genotype)) +
geom_ribbon(aes(ymin = median - st_dev, ymax = median + st_dev, fill = genotype,alpha = 80)) +
geom_line(size = 3) +
scale_colour_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
scale_fill_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
#facet_grid(cols = vars(genotype)) +
ylab("expression in log2 RPKM") +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5), legend.position = "none") -> expression_germline_line
expression_germline_line
germline_summary %>%
ggplot(aes(stage, median, colour = genotype, group = genotype)) +
geom_ribbon(aes(ymin = median - st_dev, ymax = median + st_dev, fill = genotype,alpha = 80), outline.type = "none") +
geom_line(size = 3) +
scale_colour_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
scale_fill_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
#facet_grid(cols = vars(genotype)) +
ylab("expression in log2 RPKM") +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5), legend.position = "none") -> expression_germline_line
germline_summary %>%
ggplot(aes(stage, median, colour = genotype, group = genotype)) +
geom_ribbon(aes(ymin = median - st_dev, ymax = median + st_dev, fill = genotype, alpha = 80), linewidth = 0) +
geom_line(size = 3) +
scale_colour_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
scale_fill_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
#facet_grid(cols = vars(genotype)) +
ylab("expression in log2 RPKM") +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5), legend.position = "none") -> expression_germline_line
expression_germline_line
germline_summary %>%
ggplot(aes(stage, median, colour = genotype, group = genotype)) +
geom_ribbon(aes(ymin = median - st_dev, ymax = median + st_dev, fill = genotype, alpha = 10), linewidth = 0) +
geom_line(size = 3) +
scale_colour_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
scale_fill_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
#facet_grid(cols = vars(genotype)) +
ylab("expression in log2 RPKM") +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5), legend.position = "none") -> expression_germline_line
expression_germline_line
germline_summary %>%
ggplot(aes(stage, median, colour = genotype, group = genotype)) +
geom_ribbon(aes(ymin = median - st_dev, ymax = median + st_dev, fill = genotype, alpha = 0.1), linewidth = 0) +
geom_line(size = 3) +
scale_colour_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
scale_fill_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
#facet_grid(cols = vars(genotype)) +
ylab("expression in log2 RPKM") +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5), legend.position = "none") -> expression_germline_line
expression_germline_line
germline_summary %>%
ggplot(aes(stage, median, colour = genotype, group = genotype)) +
geom_ribbon(aes(ymin = median - st_dev, ymax = median + st_dev, fill = genotype), linewidth = 0, alpha = 0.1) +
geom_line(size = 3) +
scale_colour_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
scale_fill_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
#facet_grid(cols = vars(genotype)) +
ylab("expression in log2 RPKM") +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5), legend.position = "none") -> expression_germline_line
expression_germline_line
germline_summary %>%
ggplot(aes(stage, median, colour = genotype, group = genotype)) +
geom_ribbon(aes(ymin = median - st_dev, ymax = median + st_dev, fill = genotype), linewidth = 0, alpha = 0.2) +
geom_line(size = 3) +
scale_colour_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
scale_fill_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
#facet_grid(cols = vars(genotype)) +
ylab("expression in log2 RPKM") +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5), legend.position = "none") -> expression_germline_line
expression_germline_line
germline_summary %>%
ggplot(aes(stage, median, colour = genotype, group = genotype)) +
geom_ribbon(aes(ymin = median - st_dev, ymax = median + st_dev, fill = genotype), linewidth = 0, alpha = 0.15) +
geom_line(size = 3) +
scale_colour_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
scale_fill_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
#facet_grid(cols = vars(genotype)) +
ylab("expression in log2 RPKM") +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5), legend.position = "none") -> expression_germline_line
expression_germline_line
germline_summary %>%
ggplot(aes(stage, median, colour = genotype, group = genotype)) +
geom_ribbon(aes(ymin = median - st_dev, ymax = median + st_dev, fill = genotype), linewidth = 0, alpha = 0.15) +
geom_line(size = 3) +
scale_colour_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
scale_fill_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
#facet_grid(cols = vars(genotype)) +
ylab("expression in log2 RPKM") +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5), legend.position = "none") -> expression_germline_line
expression_germline_line
germline_summary %>%
ggplot(aes(stage, median, colour = genotype, group = genotype)) +
geom_ribbon(aes(ymin = median - st_dev, ymax = median + st_dev, fill = genotype), linewidth = 0, alpha = 0.15) +
geom_line(size = 3) +
scale_colour_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
scale_fill_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
#facet_grid(cols = vars(genotype)) +
ylab("expression in log2 RPKM") +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5), legend.position = "none") -> expression_germline_line
expression_germline_line
germline_summary %>%
ggplot(aes(stage, median, colour = genotype, group = genotype)) +
geom_ribbon(aes(ymin = median - st_dev, ymax = median + st_dev, fill = genotype), linewidth = 0, alpha = 0.15) +
geom_line(size = 2) +
scale_colour_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
scale_fill_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
#facet_grid(cols = vars(genotype)) +
ylab("expression in log2 RPKM") +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5), legend.position = "none") -> expression_germline_line
expression_germline_line
germline_summary %>%
ggplot(aes(stage, median, colour = genotype, group = genotype)) +
geom_ribbon(aes(ymin = median - st_dev, ymax = median + st_dev, fill = genotype), linewidth = 0, alpha = 0.15) +
geom_line(size = 2) +
scale_colour_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
scale_fill_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
#facet_grid(cols = vars(genotype)) +
ylab("expression in log2 RPKM") +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5), legend.position = "none") -> expression_germline_line
expression_germline_line
germline_summary %>%
ggplot(aes(stage, median, colour = genotype, group = genotype)) +
geom_ribbon(aes(ymin = median - st_dev, ymax = median + st_dev, fill = genotype), linewidth = 0, alpha = 0.15) +
geom_line(size = 2) +
scale_colour_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
scale_fill_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
#facet_grid(cols = vars(genotype)) +
ylab("expression in log2 RPKM") +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5)) -> expression_germline_line
expression_germline_line
germline_summary %>%
ggplot(aes(stage, median, colour = genotype, group = genotype)) +
geom_ribbon(aes(ymin = median - st_dev, ymax = median + st_dev, fill = genotype), linewidth = 0, alpha = 0.15) +
geom_line(size = 2) +
scale_colour_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
scale_fill_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
#facet_grid(cols = vars(genotype)) +
ylab("expression in log2 RPKM") +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5), legend.title = element_blank()) -> expression_germline_line
expression_germline_line
germline_gene_expression %>%
group_by(stage, genotype) %>%
summarise(median = median(expression), quant_75 = quantile(expression, .75))  %>%
ungroup() -> germline_summary
head(germline_summary)
germline_gene_expression %>%
group_by(stage, genotype) %>%
summarise(median = median(expression), quant_75 = quantile(expression, .75))  %>%
ungroup() -> germline_summary
# germline_gene_expression %>%
#   group_by(stage, genotype) %>%
#   summarise(median = median(expression), st_dev = sd(expression))  %>%
#   ungroup() -> germline_summary
germline_gene_expression %>%
group_by(stage, genotype) %>%
summarise(median = median(expression), quant_75 = quantile(expression, .75), , quant_25 = quantile(expression, .25))  %>%
ungroup() -> germline_summary
head(germline_summary)
# germline_gene_expression %>%
#   group_by(stage, genotype) %>%
#   summarise(median = median(expression), st_dev = sd(expression))  %>%
#   ungroup() -> germline_summary
germline_gene_expression %>%
group_by(stage, genotype) %>%
summarise(median = median(expression), quant_75 = quantile(expression, .75), , quant_25 = quantile(expression, .25))  %>%
ungroup() -> germline_summary
head(germline_summary)
germline_summary %>%
ggplot(aes(stage, median, colour = genotype, group = genotype)) +
geom_ribbon(aes(ymin = quant_25, ymax = quant_75, fill = genotype), linewidth = 0, alpha = 0.15) +
geom_line(size = 2) +
scale_colour_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
scale_fill_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
#facet_grid(cols = vars(genotype)) +
ylab("expression in log2 RPKM") +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5), legend.title = element_blank()) -> expression_germline_line
expression_germline_line
germline_summary %>%
ggplot(aes(stage, median, colour = genotype, group = genotype)) +
geom_ribbon(aes(ymin = quant_25, ymax = quant_75, fill = genotype), linewidth = 0, alpha = 0.1) +
geom_line(size = 2) +
scale_colour_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
scale_fill_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
#facet_grid(cols = vars(genotype)) +
ylab("expression in log2 RPKM") +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5), legend.title = element_blank()) -> expression_germline_line
expression_germline_line
germline_summary %>%
ggplot(aes(stage, median, colour = genotype, group = genotype)) +
geom_ribbon(aes(ymin = quant_25, ymax = quant_75, fill = genotype), linewidth = 0, alpha = 0.1) +
geom_line(size = 2) +
scale_colour_manual(values = c(DNMT_Epi_WT_colour, "red")) +
scale_fill_manual(values = c(DNMT_Epi_WT_colour, "red")) +
#facet_grid(cols = vars(genotype)) +
ylab("expression in log2 RPKM") +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5), legend.title = element_blank()) -> expression_germline_line
expression_germline_line
germline_summary %>%
ggplot(aes(stage, median, colour = genotype, group = genotype)) +
geom_ribbon(aes(ymin = quant_25, ymax = quant_75, fill = genotype), linewidth = 0, alpha = 0.1) +
geom_line(size = 2) +
scale_colour_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
scale_fill_manual(values = c(DNMT_Epi_WT_colour, DNMT_Epi_KO_colour)) +
#facet_grid(cols = vars(genotype)) +
ylab("expression in log2 RPKM") +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5), legend.title = element_blank()) -> expression_germline_line
expression_germline_line
ggsave("../output/plots/expression_germline_line.png", expression_germline_line, width = 4, height = 3.5)
ggsave("../output/plots/expression_germline_line.svg", expression_germline_line, width = 4, height = 3.5)
source("cluster_analysis_functions.R")
library(easystats)
library(broom)
options(scipen = 0)
#read_tsv("../data/clusters_20_capped_marks_220517.txt") -> clusters_capped_marks
read_tsv("../data/clusters_20_uncapped_marks_220517.txt") -> clusters_uncapped_marks
#read_tsv("../data/pluripotency_exit_RNA_Epi_and_EB_log2RPKM.txt") -> expression_import
clusters_uncapped_marks %>%
rename_with(~gsub("H3K27Ac", "H3K27ac",.)) -> marks
colnames(marks)
marks %>%
filter(cluster_ID == "cluster16") %>%
select(contains("Epi")) -> cluster16_Epi
head(cluster16_Epi)
ks.test(cluster16_Epi$oe_H3K27ac_DNMT_WT_Epi, 'pnorm')
wilcox.test(cluster16_Epi$oe_H3K27ac_DNMT_WT_Epi, cluster16_Epi$oe_H3K27ac_DNMT_KO_Epi) %>%
tidy() %>%
mutate(comparison = "K27ac_DNMT WT vs KO") %>%
relocate(comparison, .before = statistic) -> K27ac_DNMT_stats
K27ac_DNMT_stats
cohens_d(cluster16_Epi$oe_H3K27ac_DNMT_WT_Epi, cluster16_Epi$oe_H3K27ac_DNMT_KO_Epi)
interpret_cohens_d(d = 0.12, rules = "cohen1988")
wilcox.test(cluster16_Epi$oe_H3K4me1_DNMT_WT_Epi, cluster16_Epi$oe_H3K4me1_DNMT_KO_Epi) %>%
tidy() %>%
mutate(comparison = "K4me1_DNMT WT vs KO") %>%
relocate(comparison, .before = statistic) -> K4me1_DNMT_stats
K4me1_DNMT_stats
cohens_d(cluster16_Epi$oe_H3K4me1_DNMT_WT_Epi, cluster16_Epi$oe_H3K4me1_DNMT_KO_Epi)
interpret_cohens_d(d = 0.75, rules = "cohen1988")
cohens_d(cluster16_Epi$oe_H3K27ac_TET_WT_Epi, cluster16_Epi$oe_H3K27ac_TET_KO_Epi)
interpret_cohens_d(d = 0.58, rules = "cohen1988")
cohens_d(cluster16_Epi$oe_H3K4me1_TET_WT_Epi, cluster16_Epi$oe_H3K4me1_TET_KO_Epi)
interpret_cohens_d(d = 0.48, rules = "cohen1988")
calculate_cohens_d <- function(data, variable_prefix, separator = "_") {
wt_columns <- grep(paste0("^", variable_prefix, ".*", "WT"), names(data), value = TRUE)
ko_columns <- grep(paste0("^", variable_prefix, ".*", "KO"), names(data), value = TRUE)
if (length(wt_columns) != length(ko_columns)) {
stop("Unequal number of WT and KO columns")
}
result <- tibble()
for (i in seq_along(wt_columns)) {
wt_col <- data[[wt_columns[i]]]
ko_col <- data[[ko_columns[i]]]
comparison_name <- wt_columns[i]
comparison_name <- gsub("_WT_Epi", "", comparison_name)
cohens_d_value <- cohens_d(wt_col, ko_col)
result <- bind_rows(result, tibble(Comparison = comparison_name, Cohens_d = cohens_d_value))
}
return(result)
}
calculate_cohens_d_multiple <- function(prefixes_to_calculate) {
result_nested <- calculate_cohens_d(input_tibble, variable_prefix = prefixes_to_calculate)
result_nested %>%
unnest(cols = c(Cohens_d)) -> results
return(results)
}
prefixes_to_calculate <- c("bait_H3K27ac", "oe_H3K27ac", "bait_H3K4me1", "oe_H3K4me1", "bait_H3K27me3", "oe_H3K27me3")
input_tibble <- cluster16_Epi
map(prefixes_to_calculate, calculate_cohens_d_multiple) %>%
bind_rows() %>%
separate(Comparison, into = c("fragment", "mark", "genotype")) -> cluster16_cohensd
cluster16_cohensd
marks %>%
filter(cluster_ID == "cluster12") %>%
select(contains("Epi")) -> cluster12_Epi
head(cluster12_Epi)
prefixes_to_calculate <- c("bait_H3K27ac", "oe_H3K27ac", "bait_H3K4me1", "oe_H3K4me1", "bait_H3K27me3", "oe_H3K27me3")
input_tibble <- cluster12_Epi
map(prefixes_to_calculate, calculate_cohens_d_multiple) %>%
bind_rows() %>%
separate(Comparison, into = c("fragment", "mark", "genotype")) -> cluster12_cohensd
cluster12_cohensd
marks %>%
filter(cluster_ID == "cluster2") %>%
select(contains("Epi")) -> cluster2_Epi
head(cluster2_Epi)
prefixes_to_calculate <- c("bait_H3K27ac", "oe_H3K27ac", "bait_H3K4me1", "oe_H3K4me1", "bait_H3K27me3", "oe_H3K27me3")
input_tibble <- cluster2_Epi
map(prefixes_to_calculate, calculate_cohens_d_multiple) %>%
bind_rows() %>%
separate(Comparison, into = c("fragment", "mark", "genotype")) -> cluster2_cohensd
cluster2_cohensd
marks %>%
filter(cluster_ID == "cluster17") %>%
select(contains("Epi")) -> cluster17_Epi
head(cluster17_Epi)
prefixes_to_calculate <- c("bait_H3K27ac", "oe_H3K27ac", "bait_H3K4me1", "oe_H3K4me1", "bait_H3K27me3", "oe_H3K27me3")
input_tibble <- cluster17_Epi
map(prefixes_to_calculate, calculate_cohens_d_multiple) %>%
bind_rows() %>%
separate(Comparison, into = c("fragment", "mark", "genotype")) -> cluster17_cohensd
cluster17_cohensd
cluster16_cohensd %>%
rename(`Active E (16)` = Cohens_d) %>%
select(mark, fragment, genotype, `Active E (16)`) -> cluster16_temp
cluster12_cohensd %>%
rename(`Primed E (12)` = Cohens_d) %>%
select(mark, fragment, genotype, `Primed E (12)`) -> cluster12_temp
cluster2_cohensd %>%
rename(`Polycomb (2)` = Cohens_d) %>%
select(mark, fragment, genotype, `Polycomb (2)`) -> cluster2_temp
cluster17_cohensd %>%
rename(`Poised E (17)` = Cohens_d) %>%
select(mark, fragment, genotype, `Poised E (17)`) -> cluster17_temp
cluster12_temp %>%
left_join(cluster16_temp) %>%
left_join(cluster17_temp) %>%
left_join(cluster2_temp) %>%
mutate(fragment = gsub("bait", "P", fragment)) %>%
mutate(fragment = gsub("oe", "PIR", fragment)) %>%
mutate(mark = factor(mark, levels = c("H3K27me3", "H3K27ac", "H3K4me1")))  -> summary_cohensd_wide
summary_cohensd_wide %>%
pivot_longer(4:last_col(), names_to = "cluster", values_to = "Cohens_d") %>%
mutate(cluster = factor(cluster, levels = c("Active E (16)", "Primed E (12)", "Poised E (17)", "Polycomb (2)"))) %>%
mutate(Cohens_d = round(Cohens_d, digits = 2))-> summary_cohensd
summary_cohensd
summary_cohensd %>%
ggplot(aes(cluster, mark, fill = -Cohens_d)) +
geom_tile() +
geom_text(label = -(summary_cohensd$Cohens_d)) +
facet_grid(rows = vars(genotype), cols = vars(fragment)) +
#scale_fill_viridis_c(option = "turbo") +
scale_fill_distiller(palette = "RdYlBu", direction = -1, limits = c(-0.8, 0.8), na.value = "#d73026") +
theme(axis.title = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5))
summary_cohensd %>%
ggplot(aes(cluster, mark, fill = -Cohens_d)) +
geom_tile() +
geom_text(label = -(summary_cohensd$Cohens_d)) +
facet_grid(rows = vars(genotype), cols = vars(fragment)) +
#scale_fill_viridis_c(option = "turbo") +
scale_fill_distiller(palette = "RdYlBu", direction = -1, limits = c(-0.8, 0.8), na.value = "#d73026") +
theme(axis.title = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5)) -> cohens_heatmaps
cohens_heatmaps
summary_cohensd %>%
ggplot(aes(cluster, mark, fill = -Cohens_d)) +
geom_tile() +
geom_text(label = -(summary_cohensd$Cohens_d)) +
facet_grid(rows = vars(genotype), cols = vars(fragment)) +
#scale_fill_viridis_c(option = "turbo") +
scale_fill_distiller(palette = "RdYlBu", direction = -1, limits = c(-0.8, 0.8), na.value = "#d73026") +
theme(axis.title = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5)) -> cohens_heatmaps
cohens_heatmaps
summary_cohensd %>%
ggplot(aes(cluster, mark, fill = -Cohens_d)) +
geom_tile() +
geom_text(label = -(summary_cohensd$Cohens_d)) +
facet_grid(rows = vars(genotype), cols = vars(fragment)) +
#scale_fill_viridis_c(option = "turbo") +
scale_fill_distiller(palette = "RdYlBu", direction = -1, limits = c(-0.8, 0.8), na.value = "#d73026") +
theme(axis.title = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5)) -> cohens_heatmaps
cohens_heatmaps
summary_cohensd %>%
ggplot(aes(cluster, mark, fill = -Cohens_d)) +
geom_tile() +
geom_text(label = -(summary_cohensd$Cohens_d)) +
facet_grid(rows = vars(genotype), cols = vars(fragment)) +
#scale_fill_viridis_c(option = "turbo") +
scale_fill_distiller(palette = "RdYlBu", direction = -1, limits = c(-0.8, 0.8), na.value = "#d73026") +
theme(axis.title = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5), legend.title = element_blank()) -> cohens_heatmaps
cohens_heatmaps
ggsave("../output/plots/cohens_heatmaps.png", cohens_heatmaps, width = 7, height = 5)
ggsave("../output/plots/cohens_heatmaps.svg", cohens_heatmaps, width = 7, height = 5)
ggsave("../output/plots/cohens_heatmaps.png", cohens_heatmaps, width = 7, height = 5)
ggsave("../output/plots/cohens_heatmaps.svg", cohens_heatmaps, width = 7, height = 5)
install.packages("genomicranges")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("GenomicRanges")
library(GenomicRanges)
library(tidyverse)
options(scipen = 999)
