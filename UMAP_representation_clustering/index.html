
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://christelkrueger.github.io/Exit-from-Pluripotency/UMAP_representation_clustering/">
      
      
        <link rel="prev" href="../QC_and_quantitation/">
      
      
        <link rel="next" href="../network/">
      
      
      <link rel="icon" href="../images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>UMAP representation and Clustering - Exit from Pluripotency</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#umap-representation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Exit from Pluripotency" class="md-header__button md-logo" aria-label="Exit from Pluripotency" data-md-component="logo">
      
  <img src="../images/clusters_for_icon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Exit from Pluripotency
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              UMAP representation and Clustering
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Exit from Pluripotency" class="md-nav__button md-logo" aria-label="Exit from Pluripotency" data-md-component="logo">
      
  <img src="../images/clusters_for_icon.png" alt="logo">

    </a>
    Exit from Pluripotency
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../QC_and_quantitation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    QC and Quantitation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    UMAP representation and Clustering
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    UMAP representation and Clustering
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#umap-representation" class="md-nav__link">
    <span class="md-ellipsis">
      UMAP representation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#em-clustering" class="md-nav__link">
    <span class="md-ellipsis">
      EM Clustering
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#louvain-clustering" class="md-nav__link">
    <span class="md-ellipsis">
      Louvain clustering
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#marks-for-individual-clusters" class="md-nav__link">
    <span class="md-ellipsis">
      Marks for individual clusters
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Marks for individual clusters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#p-marks-em-clusters" class="md-nav__link">
    <span class="md-ellipsis">
      P marks (EM clusters)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pir-marks-em-clusters" class="md-nav__link">
    <span class="md-ellipsis">
      PIR marks (EM clusters)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#p-marks-louvain-clusters" class="md-nav__link">
    <span class="md-ellipsis">
      P marks (Louvain clusters)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pir-marks-louvain-clusters" class="md-nav__link">
    <span class="md-ellipsis">
      PIR marks (Louvain clusters)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#grouping-clusters" class="md-nav__link">
    <span class="md-ellipsis">
      Grouping clusters
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Grouping clusters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#em-cluster-grouping" class="md-nav__link">
    <span class="md-ellipsis">
      EM cluster grouping
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#louvain-cluster-grouping" class="md-nav__link">
    <span class="md-ellipsis">
      Louvain cluster grouping
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#em-and-louvain-clustering-comparison" class="md-nav__link">
    <span class="md-ellipsis">
      EM and Louvain clustering comparison
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../network/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Network
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../software/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Software
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>UMAP representation and Clustering</h1>

<h2 id="umap-representation">UMAP representation</h2>
<p>To generate a two dimensional representation of the interaction pair attributes, Uniform Manifold Approximation and Projection for Dimension Reduction (UMAP) was performed. Specifically, centred and scaled linear quantitations of the different sequencing data modalities from the EpiLC TET WT condition were subjected to UMAP using the uwot package with spectral initialisation (Settings: min_dist = 0.01, n_neibors = 2, scale = TRUE). </p>
<h2 id="em-clustering">EM Clustering</h2>
<p>To produce input for clustering, dimensionality reduction to 15 dimensions was applied to the same quantitations of interaction pair attributes (uwot, min_dist = 0.01, n_neibors = 25, scale = TRUE). Clustering was then performed by Expectation Maximisation for 20 clusters using WEKA (Scheme: weka.clusterers.EM -I 100 -N 20 -X 10 -max -1 -ll-cv 1.0E-6 -ll-iter 1.0E-6 -M 1.0E-6 -K 10 -num-slots 1 -S 100 ). </p>
<h2 id="louvain-clustering">Louvain clustering</h2>
<p>As an alternative to EM clustering and to test the robustness of the clustering approach, Louvain clustering after PCA was performed. All values of interaction pair attributes were log normalised and centred by subtracting the average. Levels were also scaled by dividing the centered attribute values by their standard deviation. Then, linear dimensionality reduction was performed by principal component analysis (PCA). The number of dimensions to use for clustering was set to 12 as gauged from the elbow plot (PC vs standard deviation). A KNN graph was constructed based on the euclidean distance in PCA space with edge weights between any two interaction pairs refined based on their shared overlap in their local neighbourhoods (Jaccard similarity) using Seurat functions (FindNeighbors(dims = 1:12), FindClusters(resolution = 1)).  </p>
<h2 id="marks-for-individual-clusters">Marks for individual clusters</h2>
<h3 id="p-marks-em-clusters">P marks (EM clusters)</h3>
<p><img alt="P marks EM clusters" src="../images/P_marks_plot_EM.png" /></p>
<h3 id="pir-marks-em-clusters">PIR marks (EM clusters)</h3>
<p><img alt="PIR marks EM clusters" src="../images/PIR_marks_plot_EM.png" /></p>
<h3 id="p-marks-louvain-clusters">P marks (Louvain clusters)</h3>
<p><img alt="P marks Louvain clusters" src="../images/P_marks_plot_Louvain.png" /></p>
<h3 id="pir-marks-louvain-clusters">PIR marks (Louvain clusters)</h3>
<p><img alt="PIR marks Louvain clusters" src="../images/PIR_marks_plot_Louvain.png" /></p>
<h2 id="grouping-clusters">Grouping clusters</h2>
<p>While the number of clusters for Louvain clustering was chosen empirically and set to 20, Louvain clustering with the given settings produced 30 clusters. However, 9 clusters had fewer than 600 interaction pairs (the larger clusters having between 14 and 21,000 interaction pairs) and were therefore excluded from further analysis.</p>
<p>We then evaluated chromatin/DNA marks per cluster and grouped them according to presumed biological function.</p>
<h3 id="em-cluster-grouping">EM cluster grouping</h3>
<p>EM activeP lowmarkedPIR: 4, 7, 10, 11, 12, 13, 18, 16</p>
<p>EM pcP unmarkedPIR: 0, 2, 9</p>
<p>EM inactiveP unmarkedPIR: 1, 5, 6, 15</p>
<p>EM inactiveP CTCFprimedE: 19</p>
<p>EM inactiveP primedE: 14</p>
<p>EM bivalentP poisedE:  3</p>
<p>EM activeP activeP: 17</p>
<p>EM activeP activeE: 8</p>
<h3 id="louvain-cluster-grouping">Louvain cluster grouping</h3>
<p>Louvain activeP lowmarkedPIR: 2, 5, 9, 13, 15, 16</p>
<p>Louvain pcP unmarkedPIR :0, 12, 17, 30</p>
<p>Louvain inactiveP unmarkedPIR: 3, 4, 7, 9, 10, 14, 21, 22, 23, 26, 27, 28, 29</p>
<p>Louvain inactiveP CTCFprimedE: 1, 19</p>
<p>Louvain inactiveP primedE: 20, 6</p>
<p>Louvain bivalentP poisedE:  18, 25</p>
<p>Louvain activeP activeP: 11, 24</p>
<p>Louvain activeP activeE: 8</p>
<h2 id="em-and-louvain-clustering-comparison">EM and Louvain clustering comparison</h2>
<figure markdown="span">
  ![UMAP with EM clusters](./images/UMAP_EM_clusters.png){ width="300" }
</figure>

<figure markdown="span">
  ![UMAO with Louvain clusters](./images/UMAP_Louvain_clusters.png){ width="300" }
</figure>







  
  




  



                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.tracking", "navigation.sections", "navigation.expand", "navigation.indexes", "toc.follow", "toc.integrate", "navigation.top"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
    
  </body>
</html>