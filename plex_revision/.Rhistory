tidy() %>%
mutate(comparison = "K4me1_DNMT WT vs KO") %>%
relocate(comparison, .before = statistic) -> K4me1_DNMT_stats
K4me1_DNMT_stats
install.packages("easystats")
source("cluster_analysis_functions.R")
library(easystats)
library(broom)
options(scipen = 0)
#read_tsv("../data/clusters_20_capped_marks_220517.txt") -> clusters_capped_marks
read_tsv("../data/clusters_20_uncapped_marks_220517.txt") -> clusters_uncapped_marks
#read_tsv("../data/pluripotency_exit_RNA_Epi_and_EB_log2RPKM.txt") -> expression_import
clusters_uncapped_marks %>%
rename_with(~gsub("H3K27Ac", "H3K27ac",.)) -> marks
colnames(marks)
clusters_uncapped_marks %>%
filter(cluster_ID == "cluster16") %>%
select(contains("Epi")) -> cluster16_Epi
head(cluster16_Epi)
ks.test(cluster16_Epi$bait_H3K27ac_DNMT_WT_Epi, 'pnorm')
wilcox.test(cluster16_Epi$bait_H3K27ac_DNMT_WT_Epi, cluster16_Epi$bait_H3K27ac_DNMT_KO_Epi) %>%
tidy() %>%
mutate(comparison = "K27ac_DNMT WT vs KO") %>%
relocate(comparison, .before = statistic) -> K27ac_DNMT_stats
K27ac_DNMT_stats
cohens_d(bait_H3K27ac_DNMT_WT_Epi ~ bait_H3K27ac_DNMT_KO_Epi, data = cluster16_Epi)
cohens_d(cluster16_Epi$bait_H3K27ac_DNMT_WT_Epi, cluster16_Epi$bait_H3K27ac_DNMT_KO_Epi)
interpret_cohens_d(d = 0.12, rules = "cohen1988")
cohens_d(cluster16_Epi$bait_H3K27ac_DNMT_WT_Epi, cluster16_Epi$bait_H3K27ac_DNMT_KO_Epi)
cohens_d(cluster16_Epi$bait_H3K27ac_DNMT_WT_Epi, cluster16_Epi$bait_H3K27ac_DNMT_KO_Epi) %>%
tidy()
cohens_d(cluster16_Epi$bait_H3K27ac_DNMT_WT_Epi, cluster16_Epi$bait_H3K27ac_DNMT_KO_Epi)
cohens_d(cluster16_Epi$bait_H3K27ac_TET_WT_Epi, cluster16_Epi$bait_H3K27ac_TET_KO_Epi)
cohens_d(cluster16_Epi$bait_H3K27ac_TET_WT_Epi, cluster16_Epi$bait_H3K27ac_TET_KO_Epi)
cluster16_Epi$bait_H3K27ac_TET_KO_Epi
cohens_d(cluster16_Epi$bait_H3K27ac_TET_WT_Epi, cluster16_Epi$bait_H3K27Ac_TET_KO_Epi)
cohens_d(cluster16_Epi$bait_H3K4me1_DNMT_WT_Epi, cluster16_Epi$CHiC_DNMT_KO_Epi)
interpret_cohens_d(d = -1.39, rules = "cohen1988")
library(tidyverse)
read_tsv("~/Downloads/salmon.merged.gene_counts.tsv") -> salmon_counts
salmon_counts
library(tidyverse)
read_csv("~/Downloads/contour-export-22-06-2023.csv") -> polaris_import
polaris_import
polaris_import
colnames(polaris_import)
polaris_import %>%
select(id, date_created, user_name, success, manifest_name)
polaris_import %>%
select(id, date_created, user_name, success, manifest_name) -> polaris_data
head(polaris_data)
polaris_data %>%
distinct(user_name)
bioinf_users <- c("fkrueger", "suhrig", "wzheng", "styanova", "ckrueger", "ktorkenczy", "byang")
polaris_data %>%
filter(user_name %in% bioinf_users)
polaris_data %>%
filter(user_name %in% bioinf_users) %>%
filter(success)
polaris_data %>%
filter(user_name %in% bioinf_users) %>%
filter(success) %>%
group_by(manifest_name) %>%
count()
polaris_data %>%
filter(user_name %in% bioinf_users) %>%
filter(success) %>%
group_by(manifest_name) %>%
count() %>%
drop_na()
polaris_data %>%
filter(user_name %in% bioinf_users) %>%
filter(success) %>%
group_by(manifest_name) %>%
count() %>%
drop_na() %>%
mutate(manifest_name = gsub("nf-core/", "", manifest_name))
polaris_data %>%
filter(user_name %in% bioinf_users) %>%
filter(success) %>%
group_by(manifest_name) %>%
count() %>%
drop_na() %>%
mutate(manifest_name = gsub("nf-core/", "", manifest_name)) -> pipelines
head(pipelines)
pipelines
pipelines %>%
ggplot(aes(manifest_name, n)) +
geom_bar()
pipelines %>%
ggplot(aes(manifest_name, n)) +
geom_col()
pipelines %>%
arrange(n)
arrange(desc(n)
pipelines %>%
pipelines %>%
arrange(desc(n))
pipelines %>%
arrange(desc(n)) %>%
mutate(manifest_name = factor(manifest_name))
pipelines %>%
arrange(desc(n)) %>%
mutate(manifest_name = factor(manifest_name)) %>%
ggplot(aes(manifest_name, n)) +
geom_col()
pipelines %>%
arrange(desc(n)) %>%
mutate(manifest_name = factor(manifest_name))
pipelines %>%
arrange(desc(n)) %>%
mutate(manifest_name = factor(manifest_name)) %>%
ggplot(aes(factor(manifest_name), n)) +
geom_col()
pipelines %>%
arrange(desc(n)) %>%
mutate(manifest_name = factor(manifest_name))
pipelines %>%
mutate(manifest_name = factor(manifest_name)) %>%
fct_reorder(manifest_name, n)
pipelines %>%
ungroup() %>%
mutate(manifest_name = factor(manifest_name)) %>%
fct_reorder(manifest_name, n)
pipelines %>%
ungroup() %>%
mutate(manifest_name = fct_reorder(manifest_name, n))
pipelines %>%
ungroup()
pipelines %>%
ungroup() %>%
mutate(manifest_name = fct_reorder(manifest_name, n, arrange()))
pipelines %>%
ungroup() %>%
mutate(manifest_name = fct_reorder(manifest_name, n, desc()))
mutate(manifest_name = fct_reorder(manifest_name, n)
pipelines %>%
pipelines %>%
ungroup() %>%
mutate(manifest_name = fct_reorder(manifest_name, n)
pipelines %>%
pipelines %>%
ungroup() %>%
mutate(manifest_name = fct_reorder(manifest_name, n))
pipelines %>%
arrange(n) %>%
pull(manifest_name)
arrange(desc((n)) %>%
pull(manifest_name) -> order
pipelines %>%
pipelines %>%
ungroup() %>%
mutate(manifest_name = factor(manifest_name, levels = order))
pull(manifest_name) -> order
pull(manifest_name) -> order
pipelines %>%
arrange(desc((n))
pipelines %>%
pipelines %>%
arrange(desc(n)) %>%
pull(manifest_name) -> order
pipelines %>%
ungroup() %>%
mutate(manifest_name = factor(manifest_name, levels = order))
order
pipelines %>%
ungroup() %>%
#mutate(manifest_name = factor(manifest_name, levels = order)) %>%
mutate(manifest_name = fct_reorder(manifest_names, n)) %>%
arrange(manifest_name)
pipelines %>%
ungroup() %>%
#mutate(manifest_name = factor(manifest_name, levels = order)) %>%
mutate(manifest_name = fct_reorder(manifest_name, n)) %>%
arrange(manifest_name)
#mutate(manifest_name = factor(manifest_name, levels = order)) %>%
mutate(manifest_name = fct_reorder(manifest_name, desc(n)) %>%
arrange(manifest_name)
pipelines %>%
pipelines %>%
ungroup() %>%
#mutate(manifest_name = factor(manifest_name, levels = order)) %>%
mutate(manifest_name = fc
pipelines %>%
pipelines %>%
ungroup() %>%
#mutate(manifest_name = factor(manifest_name, levels = order)) %>%
mutate(manifest_name = fct_reorder(manifest_name, desc(n)) %>%
arrange(manifest_name)
pipelines %>%
pipelines %>%
ungroup() %>%
#mutate(manifest_name = factor(manifest_name, levels = order)) %>%
mutate(manifest_name = fct_reorder(manifest_name, desc(n))) %>%
arrange(manifest_name)
pipelines %>%
ungroup() %>%
#mutate(manifest_name = factor(manifest_name, levels = order)) %>%
mutate(manifest_name = fct_reorder(manifest_name, desc(n))) %>%
arrange(manifest_name) %>%
ggplot(aes(factor(manifest_name), n)) +
geom_col()
pipelines %>%
ungroup() %>%
#mutate(manifest_name = factor(manifest_name, levels = order)) %>%
mutate(manifest_name = fct_reorder(manifest_name, desc(n))) %>%
arrange(manifest_name) %>%
ggplot(aes(factor(manifest_name), n)) +
geom_col() +
theme_bw(base_size = 16)
pipelines %>%
ungroup() %>%
#mutate(manifest_name = factor(manifest_name, levels = order)) %>%
mutate(manifest_name = fct_reorder(manifest_name, desc(n))) %>%
arrange(manifest_name) %>%
ggplot(aes(factor(manifest_name), n)) +
geom_col() +
theme_bw(base_size = 16) +
theme(axis.title.x = element_blank())
pipelines %>%
ungroup() %>%
#mutate(manifest_name = factor(manifest_name, levels = order)) %>%
mutate(manifest_name = fct_reorder(manifest_name, desc(n))) %>%
arrange(manifest_name) %>%
ggplot(aes(factor(manifest_name), n)) +
geom_col() +
theme_bw(base_size = 16) +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 45))
pipelines %>%
ungroup() %>%
#mutate(manifest_name = factor(manifest_name, levels = order)) %>%
mutate(manifest_name = fct_reorder(manifest_name, desc(n))) %>%
arrange(manifest_name) %>%
ggplot(aes(factor(manifest_name), n)) +
geom_col() +
theme_bw(base_size = 16) +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 45, vjust = 0))
pipelines %>%
ungroup() %>%
#mutate(manifest_name = factor(manifest_name, levels = order)) %>%
mutate(manifest_name = fct_reorder(manifest_name, desc(n))) %>%
arrange(manifest_name) %>%
ggplot(aes(factor(manifest_name), n)) +
geom_col() +
theme_bw(base_size = 16) +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 45, vjust = 0.5))
pipelines %>%
ungroup() %>%
#mutate(manifest_name = factor(manifest_name, levels = order)) %>%
mutate(manifest_name = fct_reorder(manifest_name, desc(n))) %>%
arrange(manifest_name) %>%
ggplot(aes(factor(manifest_name), n)) +
geom_col() +
theme_bw(base_size = 16) +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5))
pipelines %>%
ungroup() %>%
#mutate(manifest_name = factor(manifest_name, levels = order)) %>%
mutate(manifest_name = fct_reorder(manifest_name, desc(n))) %>%
arrange(manifest_name) %>%
ggplot(aes(factor(manifest_name), n)) +
geom_col() +
scale_fill_brewer() +
theme_bw(base_size = 16) +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5))
pipelines %>%
ungroup() %>%
#mutate(manifest_name = factor(manifest_name, levels = order)) %>%
mutate(manifest_name = fct_reorder(manifest_name, desc(n))) %>%
arrange(manifest_name) %>%
ggplot(aes(factor(manifest_name), n)) +
geom_col(fill = c("black", "red")) +
theme_bw(base_size = 16) +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5))
pipelines %>%
ungroup() %>%
#mutate(manifest_name = factor(manifest_name, levels = order)) %>%
mutate(manifest_name = fct_reorder(manifest_name, desc(n))) %>%
arrange(manifest_name) %>%
ggplot(aes(factor(manifest_name), n)) +
geom_col(fill = viridis()) +
theme_bw(base_size = 16) +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5))
pipelines %>%
arrange(desc(n)) %>%
pull(manifest_name) -> order
pipelines %>%
ungroup() %>%
#mutate(manifest_name = factor(manifest_name, levels = order)) %>%
mutate(manifest_name = fct_reorder(manifest_name, desc(n))) %>%
arrange(manifest_name) %>%
ggplot(aes(factor(manifest_name), n, fill = manifest_name)) +
geom_col(fill = viridis()) +
theme_bw(base_size = 16) +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5))
pipelines %>%
arrange(desc(n)) %>%
pull(manifest_name) -> order
pipelines %>%
ungroup() %>%
#mutate(manifest_name = factor(manifest_name, levels = order)) %>%
mutate(manifest_name = fct_reorder(manifest_name, desc(n))) %>%
arrange(manifest_name) %>%
ggplot(aes(factor(manifest_name), n, fill = manifest_name)) +
geom_col() +
theme_bw(base_size = 16) +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5))
pipelines %>%
ungroup() %>%
#mutate(manifest_name = factor(manifest_name, levels = order)) %>%
mutate(manifest_name = fct_reorder(manifest_name, desc(n))) %>%
arrange(manifest_name) %>%
ggplot(aes(factor(manifest_name), n, fill = manifest_name)) +
geom_col() +
theme_bw(base_size = 16) +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5), legend.position = "none")
pipelines %>%
arrange(desc(n)) %>%
pull(manifest_name) -> order
pipelines %>%
ungroup() %>%
#mutate(manifest_name = factor(manifest_name, levels = order)) %>%
mutate(manifest_name = fct_reorder(manifest_name, desc(n))) %>%
arrange(manifest_name) %>%
ggplot(aes(factor(manifest_name), n, fill = manifest_name)) +
geom_col() +
theme_bw(base_size = 16) +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5), legend.position = "none")
pipelines %>%
arrange(desc(n)) %>%
pull(manifest_name) -> order
pipelines %>%
ungroup() %>%
#mutate(manifest_name = factor(manifest_name, levels = order)) %>%
mutate(manifest_name = fct_reorder(manifest_name, desc(n))) %>%
arrange(manifest_name) %>%
ggplot(aes(factor(manifest_name), n, fill = manifest_name)) +
geom_col() +
theme_bw(base_size = 16) +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5), legend.position = "none")
pipelines %>%
arrange(desc(n)) %>%
pull(manifest_name) -> order
pipelines %>%
ungroup() %>%
#mutate(manifest_name = factor(manifest_name, levels = order)) %>%
mutate(manifest_name = fct_reorder(manifest_name, desc(n))) %>%
arrange(manifest_name) %>%
ggplot(aes(factor(manifest_name), n, fill = manifest_name)) +
geom_col() +
theme_bw(base_size = 16) +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5), legend.position = "none")
pipelines %>%
arrange(desc(n)) %>%
pull(manifest_name) -> order
pipelines %>%
ungroup() %>%
#mutate(manifest_name = factor(manifest_name, levels = order)) %>%
mutate(manifest_name = fct_reorder(manifest_name, desc(n))) %>%
arrange(manifest_name) %>%
ggplot(aes(factor(manifest_name), n, fill = manifest_name)) +
geom_col() +
theme_bw(base_size = 16) +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5), legend.position = "none")
pipelines %>%
arrange(desc(n)) %>%
pull(manifest_name) -> order
pipelines %>%
ungroup() %>%
#mutate(manifest_name = factor(manifest_name, levels = order)) %>%
mutate(manifest_name = fct_reorder(manifest_name, desc(n))) %>%
arrange(manifest_name) %>%
ggplot(aes(factor(manifest_name), n, fill = manifest_name)) +
geom_col() +
theme_bw(base_size = 16) +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0), legend.position = "none")
pipelines %>%
arrange(desc(n)) %>%
pull(manifest_name) -> order
pipelines %>%
ungroup() %>%
#mutate(manifest_name = factor(manifest_name, levels = order)) %>%
mutate(manifest_name = fct_reorder(manifest_name, desc(n))) %>%
arrange(manifest_name) %>%
ggplot(aes(factor(manifest_name), n, fill = manifest_name)) +
geom_col() +
theme_bw(base_size = 16) +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 0), legend.position = "none")
pipelines %>%
arrange(desc(n)) %>%
pull(manifest_name) -> order
pipelines %>%
ungroup() %>%
#mutate(manifest_name = factor(manifest_name, levels = order)) %>%
mutate(manifest_name = fct_reorder(manifest_name, desc(n))) %>%
arrange(manifest_name) %>%
ggplot(aes(factor(manifest_name), n, fill = manifest_name)) +
geom_col() +
theme_bw(base_size = 16) +
theme(axis.title.x = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1), legend.position = "none")
pipelines %>%
arrange(desc(n)) %>%
pull(manifest_name) -> order
pipelines %>%
ungroup() %>%
#mutate(manifest_name = factor(manifest_name, levels = order)) %>%
mutate(manifest_name = fct_reorder(manifest_name, desc(n))) %>%
arrange(manifest_name) %>%
ggplot(aes(factor(manifest_name), n, fill = manifest_name)) +
geom_col() +
theme_bw(base_size = 16) +
theme(axis.title = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1), legend.position = "none")
pipelines %>%
count(n)
pipelines %>%
ungroup() %>%
count(n)
pipelines %>%
rowSums()
pipelines %>%
rowSums(n)
pipelines %>%
summarise(sum(n))
pipelines %>%
ungroup() %>%
summarise(sum(n))
mutate(group = if_else(user_name %in% bioinf_users, "bioinf hub", "other") %>%
)
polaris_data %>%
mutate(group = if_else(user_name %in% bioinf_users, "bioinf hub", "other")) %>%
filter(success)
polaris_data %>%
mutate(group = if_else(user_name %in% bioinf_users, "bioinf hub", "other")) %>%
filter(success) %>%
ggplot(aes(group)) %>%
geom_bar()
polaris_data %>%
mutate(group = if_else(user_name %in% bioinf_users, "bioinf hub", "other")) %>%
filter(success) %>%
ggplot(aes(group)) +
geom_bar()
polaris_data %>%
mutate(group = if_else(user_name %in% bioinf_users, "bioinf hub", "other")) %>%
filter(success) %>%
ggplot(aes(group, fill = group)) +
geom_bar()
polaris_data %>%
mutate(group = if_else(user_name %in% bioinf_users, "bioinf hub", "other")) %>%
filter(success) %>%
ggplot(aes(group, fill = group)) +
geom_bar() +
theme_bw(base_size = 16)
polaris_data %>%
mutate(group = if_else(user_name %in% bioinf_users, "bioinf hub", "other")) %>%
filter(success) %>%
ggplot(aes(group, fill = group)) +
geom_bar() +
theme_bw(base_size = 16)
polaris_data %>%
mutate(group = if_else(user_name %in% bioinf_users, "bioinf hub", "other")) %>%
filter(success) %>%
ggplot(aes(group, fill = group)) +
geom_bar() +
theme_bw(base_size = 16)
library(tidyverse)
read_csv("~/Downloads/contour-export-23-06-2023.csv") -> polaris_import
colnames(polaris_import)
colnames(polaris_import)
polaris_import %>%
select(id, date_created, user_name, success, manifest_name) -> polaris_data
head(polaris_data)
polaris_data %>%
distinct(user_name)
bioinf_users <- c("fkrueger", "suhrig", "wzheng", "styanova", "ckrueger", "ktorkenczy", "byang")
polaris_data %>%
filter(user_name %in% bioinf_users) %>%
filter(success) %>%
group_by(manifest_name) %>%
count() %>%
drop_na() %>%
mutate(manifest_name = gsub("nf-core/", "", manifest_name)) -> pipelines
pipelines
pipelines %>%
ungroup() %>%
#mutate(manifest_name = factor(manifest_name, levels = order)) %>%
mutate(manifest_name = fct_reorder(manifest_name, desc(n))) %>%
arrange(manifest_name) %>%
ggplot(aes(factor(manifest_name), n, fill = manifest_name)) +
geom_col() +
theme_bw(base_size = 16) +
theme(axis.title = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1), legend.position = "none")
pipelines %>%
ungroup() %>%
summarise(sum(n))
polaris_data %>%
mutate(group = if_else(user_name %in% bioinf_users, "bioinf hub", "other")) %>%
filter(success) %>%
ggplot(aes(group, fill = group)) +
geom_bar() +
theme_bw(base_size = 16)
pipelines %>%
ungroup() %>%
#mutate(manifest_name = factor(manifest_name, levels = order)) %>%
mutate(manifest_name = fct_reorder(manifest_name, desc(n))) %>%
arrange(manifest_name) %>%
ggplot(aes(factor(manifest_name), n, fill = manifest_name)) +
geom_col() +
theme_bw(base_size = 16) +
theme(axis.title = element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1), legend.position = "none")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("enrichplot")
