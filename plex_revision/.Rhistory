theme(aspect.ratio = 1, plot.title = element_text(hjust = 0.5))
marks_TET_Epi_long %>%
filter(mark != "mC") %>%
filter(!Louvain_cluster_ID %in% excluded_clusters) %>%
ggplot(aes(mark, values, fill = region)) +
geom_boxplot(outlier.shape = NA) +
ylim(0, 8) +
theme_bw(base_size = 14) +
facet_grid(rows = "Louvain_cluster_ID")
# P_unmarkedPIR <- c("2", "10", "13")
# PC_P_unmarked <- c("1", "7", "14")
# inactive_unmarked <- c("0", "5")
# poised <- c( "12")
# CTCF <- c("11", "8")
# active_active <- c("3", "9")
P_unmarkedPIR <- c("1", "6", "11", "18", "20")
inactive_lowprimed <- c("9")
PC_P_unmarked <- c("2", "19", "10")
inactive_unmarked <- c("3", "5", "7", "13", "15", "16")
inactive_lowprimedCTCF <- c("4", "14")
primed <- c("12")
poised <- c("17")
p_p <- c("8")
active_activeE <- c("0")
marks_2 %>%
filter(!Louvain_cluster_ID %in% excluded_clusters) %>%
mutate(Louvain_cluster_group = case_when(Louvain_cluster_ID %in% P_unmarkedPIR ~ "active P - unmarked PIR",
Louvain_cluster_ID == inactive_lowprimed ~ "inactive P - low primed E",
Louvain_cluster_ID %in% PC_P_unmarked ~ "PC P - unmarked PIR",
Louvain_cluster_ID %in% inactive_unmarked ~ "inactive P - unmarked PIR",
Louvain_cluster_ID %in% inactive_lowprimedCTCF ~ "inactive P - low primed E, CTCF",
Louvain_cluster_ID == primed ~ "primed E",
Louvain_cluster_ID %in% poised ~ "poised E",
Louvain_cluster_ID == p_p ~ "active P - active P",
Louvain_cluster_ID %in% active_activeE ~ "active P - active E")) -> marks_3
marks_3 %>%
slice_sample(prop = 0.1) %>%
ggplot(aes(UMAP1, UMAP2, colour = Louvain_cluster_group)) +
geom_point(size = 0.1) +
theme_bw(base_size = 14) +
ggtitle("Louvain clusters") +
coord_cartesian(xlim = c(-10, 12), ylim = c(-10, 8)) +
scale_colour_manual(values = cluster_group_colours) +
theme(aspect.ratio = 1, plot.title = element_text(hjust = 0.5))
marks_KNN <- FindNeighbors(marks_PCA, dims = 1:12)
marks_Louvain <- FindClusters(marks_KNN, resolution = 1)
Idents(marks_Louvain) %>%
as.data.frame() %>%
rownames_to_column(var = "interaction_ID") %>%
rename(Louvain_cluster_ID = ".") -> Louvain_clusters
head(Louvain_clusters)
marks_import %>%
left_join(Louvain_clusters) -> marks_2
head(marks_2)
marks_import %>%
left_join(Louvain_clusters) -> marks_2
head(marks_2)
Idents(marks_Louvain) %>%
as.data.frame() %>%
rownames_to_column(var = "interaction_ID") %>%
rename(Louvain_cluster_ID = ".") -> Louvain_clusters
head(Louvain_clusters)
marks_import %>%
left_join(Louvain_clusters) -> marks_2
head(marks_2)
marks_2 %>%
slice_sample(prop = 0.1) %>%
ggplot(aes(UMAP1, UMAP2, colour = cluster_ID)) +
geom_point(size = 0.5) +
theme_bw(base_size = 14) +
ggtitle("EM clusters") +
coord_cartesian(xlim = c(-10, 12), ylim = c(-10, 8)) +
theme(aspect.ratio = 1, plot.title = element_text(hjust = 0.5))
marks_2 %>%
slice_sample(prop = 0.05) %>%
ggplot(aes(UMAP1, UMAP2, colour = Louvain_cluster_ID)) +
geom_point(size = 0.5) +
#geom_point(data = marks_2 %>% slice_sample(prop = 0.05) %>% filter(Louvain_cluster_ID == 19), size = 0.5, colour = "black") +
theme_bw(base_size = 14) +
ggtitle("Louvain clusters") +
coord_cartesian(xlim = c(-10, 12), ylim = c(-10, 8)) +
theme(aspect.ratio = 1, plot.title = element_text(hjust = 0.5))
marks_2 %>%
group_by(Louvain_cluster_ID) %>%
count()
marks_2 %>%
select(-UMAP1, -UMAP2, -P_ID, -PIR_ID, -P_gene, -PIR_gene, -contains("DNMT"), -contains("ES"), -contains("Input"), -contains("KO"), -contains("CHiC")) %>%
select(interaction_ID, cluster_ID, cluster_group, Louvain_cluster_ID, everything()) %>%
pivot_longer(5:last_col(), names_to = "condition", values_to = "values") %>%
separate(condition, into = c("region", "mark")) -> marks_TET_Epi_long
excluded_clusters <- c("21", "22", "23", "24", "25", "26", "27", "28", "29", "30")
marks_TET_Epi_long %>%
filter(mark != "mC") %>%
filter(!Louvain_cluster_ID %in% excluded_clusters) %>%
ggplot(aes(mark, values, fill = region)) +
geom_boxplot(outlier.shape = NA) +
ylim(0, 8) +
theme_bw(base_size = 14) +
facet_grid(rows = "Louvain_cluster_ID")
cluster_group_names <- c("active P - unmarked PIR",
"inactive P - low primed E",
"PC P - unmarked PIR",
"inactive P - unmarked PIR",
"inactive P - low primed E, CTCF",
"primed E",
"poised E",
"active P - active P",
"active P - active E"
)
cluster_group_colours <- c("#b785bb", "#53c2b3", "#bf6c6c", "#b2b5b5", "#741113", "#eaca48", "#ca3526", "#91c740", "#252d37")
names(cluster_group_colours) <- cluster_group_names
# P_unmarkedPIR <- c("2", "10", "13")
# PC_P_unmarked <- c("1", "7", "14")
# inactive_unmarked <- c("0", "5")
# poised <- c( "12")
# CTCF <- c("11", "8")
# active_active <- c("3", "9")
P_unmarkedPIR <- c("0", "2", "5", "13", "15")
inactive_lowprimed <- c("6")
PC_P_unmarked <- c("12", "17")
inactive_unmarked <- c("3", "4", "7", "10", "14", "16")
inactive_lowprimedCTCF <- c("1", "19")
primed <- c("20")
poised <- c("9". "18")
# P_unmarkedPIR <- c("2", "10", "13")
# PC_P_unmarked <- c("1", "7", "14")
# inactive_unmarked <- c("0", "5")
# poised <- c( "12")
# CTCF <- c("11", "8")
# active_active <- c("3", "9")
P_unmarkedPIR <- c("0", "2", "5", "13", "15")
inactive_lowprimed <- c("6")
PC_P_unmarked <- c("12", "17")
inactive_unmarked <- c("3", "4", "7", "10", "14", "16")
inactive_lowprimedCTCF <- c("1", "19")
primed <- c("20")
poised <- c("9", "18")
p_p <- c("11")
active_activeE <- c("8")
marks_2 %>%
filter(!Louvain_cluster_ID %in% excluded_clusters) %>%
mutate(Louvain_cluster_group = case_when(Louvain_cluster_ID %in% P_unmarkedPIR ~ "active P - unmarked PIR",
Louvain_cluster_ID == inactive_lowprimed ~ "inactive P - low primed E",
Louvain_cluster_ID %in% PC_P_unmarked ~ "PC P - unmarked PIR",
Louvain_cluster_ID %in% inactive_unmarked ~ "inactive P - unmarked PIR",
Louvain_cluster_ID %in% inactive_lowprimedCTCF ~ "inactive P - low primed E, CTCF",
Louvain_cluster_ID == primed ~ "primed E",
Louvain_cluster_ID %in% poised ~ "poised E",
Louvain_cluster_ID == p_p ~ "active P - active P",
Louvain_cluster_ID %in% active_activeE ~ "active P - active E")) -> marks_3
marks_3 %>%
slice_sample(prop = 0.1) %>%
ggplot(aes(UMAP1, UMAP2, colour = Louvain_cluster_group)) +
geom_point(size = 0.1) +
theme_bw(base_size = 14) +
ggtitle("Louvain clusters") +
coord_cartesian(xlim = c(-10, 12), ylim = c(-10, 8)) +
scale_colour_manual(values = cluster_group_colours) +
theme(aspect.ratio = 1, plot.title = element_text(hjust = 0.5))
marks_3 %>%
slice_sample(prop = 0.05) %>%
ggplot(aes(UMAP1, UMAP2, colour = Louvain_cluster_group)) +
geom_point(size = 0.1) +
theme_bw(base_size = 14) +
ggtitle("Louvain clusters") +
coord_cartesian(xlim = c(-10, 12), ylim = c(-10, 8)) +
scale_colour_manual(values = cluster_group_colours) +
theme(aspect.ratio = 1, plot.title = element_text(hjust = 0.5))
# P_unmarkedPIR <- c("2", "10", "13")
# PC_P_unmarked <- c("1", "7", "14")
# inactive_unmarked <- c("0", "5")
# poised <- c( "12")
# CTCF <- c("11", "8")
# active_active <- c("3", "9")
P_unmarkedPIR <- c("2", "5", "13", "15")
inactive_lowprimed <- c("6")
PC_P_unmarked <- c("0", "12", "17")
inactive_unmarked <- c("3", "4", "7", "10", "14", "16")
inactive_lowprimedCTCF <- c("1", "19")
primed <- c("20")
poised <- c("9", "18")
p_p <- c("11")
active_activeE <- c("8")
marks_2 %>%
filter(!Louvain_cluster_ID %in% excluded_clusters) %>%
mutate(Louvain_cluster_group = case_when(Louvain_cluster_ID %in% P_unmarkedPIR ~ "active P - unmarked PIR",
Louvain_cluster_ID == inactive_lowprimed ~ "inactive P - low primed E",
Louvain_cluster_ID %in% PC_P_unmarked ~ "PC P - unmarked PIR",
Louvain_cluster_ID %in% inactive_unmarked ~ "inactive P - unmarked PIR",
Louvain_cluster_ID %in% inactive_lowprimedCTCF ~ "inactive P - low primed E, CTCF",
Louvain_cluster_ID == primed ~ "primed E",
Louvain_cluster_ID %in% poised ~ "poised E",
Louvain_cluster_ID == p_p ~ "active P - active P",
Louvain_cluster_ID %in% active_activeE ~ "active P - active E")) -> marks_3
marks_3 %>%
slice_sample(prop = 0.05) %>%
ggplot(aes(UMAP1, UMAP2, colour = Louvain_cluster_group)) +
geom_point(size = 0.1) +
theme_bw(base_size = 14) +
ggtitle("Louvain clusters") +
coord_cartesian(xlim = c(-10, 12), ylim = c(-10, 8)) +
scale_colour_manual(values = cluster_group_colours) +
theme(aspect.ratio = 1, plot.title = element_text(hjust = 0.5))
marks_2 %>%
slice_sample(prop = 0.05) %>%
ggplot(aes(UMAP1, UMAP2, colour = Louvain_cluster_ID)) +
geom_point(size = 0.5) +
geom_point(data = marks_2 %>% slice_sample(prop = 0.05) %>% filter(Louvain_cluster_ID == 9), size = 0.5, colour = "black") +
theme_bw(base_size = 14) +
ggtitle("Louvain clusters") +
coord_cartesian(xlim = c(-10, 12), ylim = c(-10, 8)) +
theme(aspect.ratio = 1, plot.title = element_text(hjust = 0.5))
# P_unmarkedPIR <- c("2", "10", "13")
# PC_P_unmarked <- c("1", "7", "14")
# inactive_unmarked <- c("0", "5")
# poised <- c( "12")
# CTCF <- c("11", "8")
# active_active <- c("3", "9")
P_unmarkedPIR <- c("2", "5", "13", "15")
inactive_lowprimed <- c("6")
PC_P_unmarked <- c("0", "12", "17")
inactive_unmarked <- c("3", "4", "7", "9", "10", "14", "16")
inactive_lowprimedCTCF <- c("1", "19")
primed <- c("20", "6")
poised <- c( "18")
p_p <- c("11")
active_activeE <- c("8")
marks_2 %>%
filter(!Louvain_cluster_ID %in% excluded_clusters) %>%
mutate(Louvain_cluster_group = case_when(Louvain_cluster_ID %in% P_unmarkedPIR ~ "active P - unmarked PIR",
Louvain_cluster_ID == inactive_lowprimed ~ "inactive P - low primed E",
Louvain_cluster_ID %in% PC_P_unmarked ~ "PC P - unmarked PIR",
Louvain_cluster_ID %in% inactive_unmarked ~ "inactive P - unmarked PIR",
Louvain_cluster_ID %in% inactive_lowprimedCTCF ~ "inactive P - low primed E, CTCF",
Louvain_cluster_ID == primed ~ "primed E",
Louvain_cluster_ID %in% poised ~ "poised E",
Louvain_cluster_ID == p_p ~ "active P - active P",
Louvain_cluster_ID %in% active_activeE ~ "active P - active E")) -> marks_3
marks_3 %>%
slice_sample(prop = 0.05) %>%
ggplot(aes(UMAP1, UMAP2, colour = Louvain_cluster_group)) +
geom_point(size = 0.1) +
theme_bw(base_size = 14) +
ggtitle("Louvain clusters") +
coord_cartesian(xlim = c(-10, 12), ylim = c(-10, 8)) +
scale_colour_manual(values = cluster_group_colours) +
theme(aspect.ratio = 1, plot.title = element_text(hjust = 0.5))
marks_2 %>%
slice_sample(prop = 0.05) %>%
ggplot(aes(UMAP1, UMAP2, colour = Louvain_cluster_ID)) +
geom_point(size = 0.5) +
geom_point(data = marks_2 %>% slice_sample(prop = 0.05) %>% filter(Louvain_cluster_ID == 6), size = 0.5, colour = "black") +
theme_bw(base_size = 14) +
ggtitle("Louvain clusters") +
coord_cartesian(xlim = c(-10, 12), ylim = c(-10, 8)) +
theme(aspect.ratio = 1, plot.title = element_text(hjust = 0.5))
marks_2 %>%
slice_sample(prop = 0.05) %>%
ggplot(aes(UMAP1, UMAP2, colour = Louvain_cluster_ID)) +
geom_point(size = 0.5) +
geom_point(data = marks_2 %>% slice_sample(prop = 0.05) %>% filter(Louvain_cluster_ID == 10), size = 0.5, colour = "black") +
theme_bw(base_size = 14) +
ggtitle("Louvain clusters") +
coord_cartesian(xlim = c(-10, 12), ylim = c(-10, 8)) +
theme(aspect.ratio = 1, plot.title = element_text(hjust = 0.5))
marks_2 %>%
slice_sample(prop = 0.05) %>%
ggplot(aes(UMAP1, UMAP2, colour = Louvain_cluster_ID)) +
geom_point(size = 0.5) +
geom_point(data = marks_2 %>% slice_sample(prop = 0.05) %>% filter(Louvain_cluster_ID == 5), size = 0.5, colour = "black") +
theme_bw(base_size = 14) +
ggtitle("Louvain clusters") +
coord_cartesian(xlim = c(-10, 12), ylim = c(-10, 8)) +
theme(aspect.ratio = 1, plot.title = element_text(hjust = 0.5))
marks_2 %>%
slice_sample(prop = 0.05) %>%
ggplot(aes(UMAP1, UMAP2, colour = Louvain_cluster_ID)) +
geom_point(size = 0.5) +
geom_point(data = marks_2 %>% slice_sample(prop = 0.05) %>% filter(Louvain_cluster_ID == 9), size = 0.5, colour = "black") +
theme_bw(base_size = 14) +
ggtitle("Louvain clusters") +
coord_cartesian(xlim = c(-10, 12), ylim = c(-10, 8)) +
theme(aspect.ratio = 1, plot.title = element_text(hjust = 0.5))
# P_unmarkedPIR <- c("2", "10", "13")
# PC_P_unmarked <- c("1", "7", "14")
# inactive_unmarked <- c("0", "5")
# poised <- c( "12")
# CTCF <- c("11", "8")
# active_active <- c("3", "9")
P_unmarkedPIR <- c("2", "5", "13", "15")
inactive_lowprimed <- c("9")
PC_P_unmarked <- c("0", "12", "17")
inactive_unmarked <- c("3", "4", "7", "9", "10", "14", "16")
inactive_lowprimedCTCF <- c("1", "19")
primed <- c("20", "6")
poised <- c( "18")
p_p <- c("11")
active_activeE <- c("8")
marks_2 %>%
filter(!Louvain_cluster_ID %in% excluded_clusters) %>%
mutate(Louvain_cluster_group = case_when(Louvain_cluster_ID %in% P_unmarkedPIR ~ "active P - unmarked PIR",
Louvain_cluster_ID == inactive_lowprimed ~ "inactive P - low primed E",
Louvain_cluster_ID %in% PC_P_unmarked ~ "PC P - unmarked PIR",
Louvain_cluster_ID %in% inactive_unmarked ~ "inactive P - unmarked PIR",
Louvain_cluster_ID %in% inactive_lowprimedCTCF ~ "inactive P - low primed E, CTCF",
Louvain_cluster_ID == primed ~ "primed E",
Louvain_cluster_ID %in% poised ~ "poised E",
Louvain_cluster_ID == p_p ~ "active P - active P",
Louvain_cluster_ID %in% active_activeE ~ "active P - active E")) -> marks_3
marks_3 %>%
slice_sample(prop = 0.05) %>%
ggplot(aes(UMAP1, UMAP2, colour = Louvain_cluster_group)) +
geom_point(size = 0.1) +
theme_bw(base_size = 14) +
ggtitle("Louvain clusters") +
coord_cartesian(xlim = c(-10, 12), ylim = c(-10, 8)) +
scale_colour_manual(values = cluster_group_colours) +
theme(aspect.ratio = 1, plot.title = element_text(hjust = 0.5))
marks_3 %>%
slice_sample(prop = 0.1) %>%
ggplot(aes(UMAP1, UMAP2, colour = Louvain_cluster_group)) +
geom_point(size = 0.1) +
theme_bw(base_size = 14) +
ggtitle("Louvain clusters") +
coord_cartesian(xlim = c(-10, 12), ylim = c(-10, 8)) +
scale_colour_manual(values = cluster_group_colours) +
theme(aspect.ratio = 1, plot.title = element_text(hjust = 0.5))
marks_3 %>%
slice_sample(prop = 0.1) %>%
ggplot(aes(UMAP1, UMAP2, colour = Louvain_cluster_group)) +
geom_point(size = 0.5) +
theme_bw(base_size = 14) +
ggtitle("Louvain clusters") +
coord_cartesian(xlim = c(-10, 12), ylim = c(-10, 8)) +
scale_colour_manual(values = cluster_group_colours) +
theme(aspect.ratio = 1, plot.title = element_text(hjust = 0.5))
marks_3 %>%
slice_sample(prop = 0.05) %>%
ggplot(aes(UMAP1, UMAP2, colour = Louvain_cluster_group)) +
geom_point(size = 0.5) +
theme_bw(base_size = 14) +
ggtitle("Louvain clusters") +
coord_cartesian(xlim = c(-10, 12), ylim = c(-10, 8)) +
scale_colour_manual(values = cluster_group_colours) +
theme(aspect.ratio = 1, plot.title = element_text(hjust = 0.5))
marks_3 %>%
slice_sample(prop = 0.01) %>%
ggplot(aes(UMAP1, UMAP2, colour = Louvain_cluster_group)) +
geom_point(size = 0.5) +
theme_bw(base_size = 14) +
ggtitle("Louvain clusters") +
coord_cartesian(xlim = c(-10, 12), ylim = c(-10, 8)) +
scale_colour_manual(values = cluster_group_colours) +
theme(aspect.ratio = 1, plot.title = element_text(hjust = 0.5))
marks_3 %>%
slice_sample(prop = 0.02) %>%
ggplot(aes(UMAP1, UMAP2, colour = Louvain_cluster_group)) +
geom_point(size = 0.5) +
theme_bw(base_size = 14) +
ggtitle("Louvain clusters") +
coord_cartesian(xlim = c(-10, 12), ylim = c(-10, 8)) +
scale_colour_manual(values = cluster_group_colours) +
theme(aspect.ratio = 1, plot.title = element_text(hjust = 0.5))
marks_3 %>%
slice_sample(prop = 0.02) %>%
ggplot(aes(UMAP1, UMAP2, colour = Louvain_cluster_group)) +
geom_point(size = 0.2) +
theme_bw(base_size = 14) +
ggtitle("Louvain clusters") +
coord_cartesian(xlim = c(-10, 12), ylim = c(-10, 8)) +
scale_colour_manual(values = cluster_group_colours) +
theme(aspect.ratio = 1, plot.title = element_text(hjust = 0.5))
marks_3 %>%
slice_sample(prop = 0.05) %>%
ggplot(aes(UMAP1, UMAP2, colour = Louvain_cluster_group)) +
geom_point(size = 0.2) +
theme_bw(base_size = 14) +
ggtitle("Louvain clusters") +
coord_cartesian(xlim = c(-10, 12), ylim = c(-10, 8)) +
scale_colour_manual(values = cluster_group_colours) +
theme(aspect.ratio = 1, plot.title = element_text(hjust = 0.5))
marks_3 %>%
slice_sample(prop = 0.05) %>%
ggplot(aes(UMAP1, UMAP2, colour = Louvain_cluster_group)) +
geom_point(size = 0.5) +
theme_bw(base_size = 14) +
ggtitle("Louvain clusters") +
coord_cartesian(xlim = c(-10, 12), ylim = c(-10, 8)) +
scale_colour_manual(values = cluster_group_colours) +
theme(aspect.ratio = 1, plot.title = element_text(hjust = 0.5))
read_tsv("../data/umap_mark_data_uncapped.txt") -> marks_import
head(marks_import)
colnames(marks_import)
library(uwot)
library(tidyverse)
options(scipen = 999)
library(uwot)
library(tidyverse)
options(scipen = 999)
read_tsv("../data/umap_mark_data_uncapped.txt") -> marks_import
head(marks_import)
colnames(marks_import)
marks_import %>%
select(interaction_ID, contains("TET"), conatins("EpiLC"), contains("WT"))
marks_import %>%
select(interaction_ID, contains("TET"), contains("EpiLC"), contains("WT"))
marks_import %>%
select(interaction_ID, contains("TET"), contains("EpiLC"), contains("WT"), contains("D2"))
marks_import %>%
select(interaction_ID, -contains("DNMT"), -contains("ES"), -contains("KO"), -contains("D0"))
marks_import %>%
select(interaction_ID, contains("TET"), contains("EpiLC"), contains("WT"), contains("D2"))
marks_import %>%
select(interaction_ID, contains("TET")) %>%
select(interaction_ID, contains("EpiLC"))
marks_import %>%
select(interaction_ID, contains("TET")) %>%
select(interaction_ID, contains("EpiLC")) %>%
select(interaction_ID, contains("WT")) %>%
select(interaction_ID, contains("D2"))
marks_import %>%
select(interaction_ID, contains("TET")) %>%
select(interaction_ID, contains("EpiLC")) %>%
select(interaction_ID, contains("WT")) %>%
select(interaction_ID, contains("D2")) %>%
select(-contains("Input"))
marks_import %>%
select(interaction_ID, contains("TET")) %>%
select(interaction_ID, contains("EpiLC")) %>%
select(interaction_ID, contains("WT")) %>%
select(interaction_ID, contains("D2")) %>%
select(-contains("Input")) %>%
rename_with(~ gsub("WT_EpiLC_D2", "",.))
marks_import %>%
select(interaction_ID, contains("TET")) %>%
select(interaction_ID, contains("EpiLC")) %>%
select(interaction_ID, contains("WT")) %>%
select(interaction_ID, contains("D2")) %>%
select(-contains("Input")) %>%
rename_with(~ gsub("WT_EpiLC_D2", "",.)) %>%
column_to_rownames(var = interaction_ID)
marks_import %>%
select(interaction_ID, contains("TET")) %>%
select(interaction_ID, contains("EpiLC")) %>%
select(interaction_ID, contains("WT")) %>%
select(interaction_ID, contains("D2")) %>%
select(-contains("Input")) %>%
rename_with(~ gsub("WT_EpiLC_D2", "",.)) %>%
column_to_rownames(var = "interaction_ID") -> marks_for_umap
head(marks_for_umap)
uwot::umap(marks_for_umap, n_neighbors = 2, min_dist = 0.01, scale = TRUE) -> umap_2_dim
head(umap_2_dim)
umap_2_dim %>%
as_tibble() -> umap_2
head(umap_2)
umap_2_dim
umap_2_dim %>%
rownames_to_column(var = "interaction_ID") %>%
as_tibble() -> umap_2
umap_2_dim %>%
rownames_to_column() %>%
as_tibble() -> umap_2
umap_2_dim %>%
as_data_frame() %>%
rownames_to_column(var = "interaction_ID") %>%
as_tibble() -> umap_2
head(umap_2)
umap_2_dim %>%
as_data_frame()
umap_2_dim
type(umap_2_dim)
umap_2_dim %>%
data.frame()
umap_2_dim %>%
data.frame() %>%
rownames_to_column(var = "interaction_ID") %>%
as_tibble() -> umap_2
head(umap_2)
umap_2 %>%
ggplot(aes(X1, X2)) +
geom_point(size = 0.1)
uwot::umap(marks_for_umap, n_neighbors = 20, min_dist = 0.01, scale = TRUE) -> umap_2_dim
umap_2_dim %>%
data.frame() %>%
rownames_to_column(var = "interaction_ID") %>%
as_tibble() -> umap_2
head(umap_2)
umap_2 %>%
ggplot(aes(X1, X2)) +
geom_point(size = 0.1)
umap_2 %>%
sample_frac(size = 0.2) %>%
ggplot(aes(X1, X2)) +
geom_point(size = 0.1) +
coord_cartesian(xlim = c(10, 10), ylim = c(10, 10))
umap_2 %>%
sample_frac(size = 0.2) %>%
ggplot(aes(X1, X2)) +
geom_point(size = 0.1) +
coord_cartesian(xlim = c(-10, 10), ylim = c(-10, 10))
umap_2 %>%
sample_frac(size = 0.2) %>%
ggplot(aes(X1, X2)) +
geom_point(size = 0.1) +
coord_cartesian(xlim = c(-10, 10), ylim = c(-10, 10)) %>%
theme(aspect.ratio = 1)
umap_2 %>%
sample_frac(size = 0.2) %>%
ggplot(aes(X1, X2)) +
geom_point(size = 0.1) +
coord_cartesian(xlim = c(-10, 10), ylim = c(-10, 10)) +
theme(aspect.ratio = 1)
