{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Exit from Pluripotency","text":"<p>This page documents quality control, data handling, analysis and visualisation associated with the data presented in </p> <p>Dynamic DNA methylation turnover at the exit of pluripotency epigenetically primes gene regulatory elements for hematopoietic lineage specification</p> <p>Aled Parry, Christel Krueger, Tim Lohoff Steven Wingett, Stefan Schoenfelder, Wolf Reik</p>"},{"location":"QC_and_quantitation/","title":"QC and Quantitation","text":""},{"location":"QC_and_quantitation/#quality-control","title":"Quality control","text":"<p>Trimming, mapping, FastQC and FastqQScreen reports were collated using MultiQC. WGBS and PCHiC sample quality was assessed with Bismark and HiCUP reports, respectively. </p> <p>Post-mapping QC was performed with Seqmonk and Vistories assessing data distribution, data grouping, duplication, coverage, enrichment and any other specifics can be viewed here for each of the marks:</p> <ul> <li>TET ATAC</li> <li>TET CTCF</li> <li>TET H3K4me1</li> <li>TET H3K4me3</li> <li>TET H3K27ac</li> <li>TET H3K27me3</li> <li> <p>TET RNA</p> </li> <li> <p>DNMT ATAC</p> </li> <li>DNMT CTCF</li> <li>DNMT H3K4me1</li> <li>DNMT H3K4me3</li> <li>DNMT H3K27ac</li> <li>DNMT H3K27me3</li> <li> <p>DNMT RNA</p> </li> <li> <p>DNMT and TET WGBS</p> </li> <li>DNMT and TET HMCP</li> </ul>"},{"location":"QC_and_quantitation/#excluded-regions","title":"Excluded regions","text":"<p>ChIP input samples were used to exclude coverage outliers and some regions which were represented differently in DNMT and TET cell lines. Details can be found in this Seqmonk Vistory and the genomic locations (GRCm38) can be downloaded here.</p>"},{"location":"QC_and_quantitation/#quantitation","title":"Quantitation","text":"<p>PCHiC data as given in linear CHiCAGO scores (-log weighted p-values), if an interaction was found in both directions, the maximum score was used. Interactions were called significant and included in the analysis if their CHiCAGO score was \u2265 5 in any of the conditions as suggested by the method authors.</p> <p>To integrate PCHiC with ChIP, ATAC and HMCP data, reads were quantitated across HindIII fragments and normalised for length and total number of reads in the sample (RPKM).</p> <p>WGBS data was quantitated across 100 CpG using the Seqmonk methylation quantitation pipeline (min count per position = 1, min number of observations = 20) and is expressed in percent. To obtain methylation levels on HindIII fragment resolution, fragments were overlapped with 100 CpG windows. If a HindIII fragment overlapped with more than one 100 CpG window, the average was taken.</p> <p>RNA data was quantitated using the Seqmonk RNA-Seq quantitation pipeline and is given as log2 RPKM values.</p> <p>All values are replicate averages.</p>"},{"location":"QC_and_quantitation/#data-integration","title":"Data integration","text":"<p>PCHiC interacting pairs form the basis for UMAP and network representations. Quantitated data from different modalities were collated in a data table in which rows represent an interaction pair and columns are attributes of the interaction (PCHiC) or the respective bait and promoter interacting region (PIR) (ATAC, ChIP, HMCP, WGBS). Values are linear. For some visualisations (were level of the mark was represented as colour) capped values were used to obtain a more reasonable scale. Caps were introduced at 3x MAD (mean absolute deviation). Both bait and PIR were annotated with promoters (overlapping gene start coordinates); if more than one promoter was present in the HindIII fragment, the most upstream was used. Data tables for both raw and capped quantitations by interaction pair are provided as processed data on GEO.</p>"},{"location":"UMAP_representation_clustering/","title":"UMAP representation and Clustering","text":""},{"location":"UMAP_representation_clustering/#umap-representation","title":"UMAP representation","text":"<p>To generate a two dimensional representation of the interaction pair attributes, Uniform Manifold Approximation and Projection for Dimension Reduction (UMAP) was performed. Specifically, centred and scaled linear quantitations of the different sequencing data modalities from the EpiLC TET WT condition were subjected to UMAP using the uwot package with spectral initialisation (Settings: min_dist = 0.01, n_neibors = 2, scale = TRUE). </p>"},{"location":"UMAP_representation_clustering/#em-clustering","title":"EM Clustering","text":"<p>To produce input for clustering, dimensionality reduction to 15 dimensions was applied to the same quantitations of interaction pair attributes (uwot, min_dist = 0.01, n_neibors = 25, scale = TRUE). Clustering was then performed by Expectation Maximisation for 20 clusters using WEKA (Scheme: weka.clusterers.EM -I 100 -N 20 -X 10 -max -1 -ll-cv 1.0E-6 -ll-iter 1.0E-6 -M 1.0E-6 -K 10 -num-slots 1 -S 100 ). </p>"},{"location":"UMAP_representation_clustering/#louvain-clustering","title":"Louvain clustering","text":"<p>As an alternative to EM clustering and to test the robustness of the clustering approach, Louvain clustering after PCA was performed. All values of interaction pair attributes were log normalised and centred by subtracting the average. Levels were also scaled by dividing the centered attribute values by their standard deviation. Then, linear dimensionality reduction was performed by principal component analysis (PCA). The number of dimensions to use for clustering was set to 12 as gauged from the elbow plot (PC vs standard deviation). A KNN graph was constructed based on the euclidean distance in PCA space with edge weights between any two interaction pairs refined based on their shared overlap in their local neighbourhoods (Jaccard similarity) using Seurat functions (FindNeighbors(dims = 1:12), FindClusters(resolution = 1)).  </p>"},{"location":"UMAP_representation_clustering/#marks-for-individual-clusters","title":"Marks for individual clusters","text":""},{"location":"UMAP_representation_clustering/#p-marks-em-clusters","title":"P marks (EM clusters)","text":""},{"location":"UMAP_representation_clustering/#pir-marks-em-clusters","title":"PIR marks (EM clusters)","text":""},{"location":"UMAP_representation_clustering/#p-marks-louvain-clusters","title":"P marks (Louvain clusters)","text":""},{"location":"UMAP_representation_clustering/#pir-marks-louvain-clusters","title":"PIR marks (Louvain clusters)","text":""},{"location":"UMAP_representation_clustering/#grouping-clusters","title":"Grouping clusters","text":"<p>While the number of clusters for Louvain clustering was chosen empirically and set to 20, Louvain clustering with the given settings produced 30 clusters. However, 9 clusters had fewer than 600 interaction pairs (the larger clusters having between 14 and 21,000 interaction pairs) and were therefore excluded from further analysis.</p> <p>We then evaluated chromatin/DNA marks per cluster and grouped them according to presumed biological function.</p>"},{"location":"UMAP_representation_clustering/#em-cluster-grouping","title":"EM cluster grouping","text":"<p>EM activeP lowmarkedPIR: 4, 7, 10, 11, 12, 13, 18, 16</p> <p>EM pcP unmarkedPIR: 0, 2, 9</p> <p>EM inactiveP unmarkedPIR: 1, 5, 6, 15</p> <p>EM inactiveP CTCFprimedE: 19</p> <p>EM inactiveP primedE: 14</p> <p>EM bivalentP poisedE:  3</p> <p>EM activeP activeP: 17</p> <p>EM activeP activeE: 8</p>"},{"location":"UMAP_representation_clustering/#louvain-cluster-grouping","title":"Louvain cluster grouping","text":"<p>Louvain activeP lowmarkedPIR: 2, 5, 9, 13, 15, 16</p> <p>Louvain pcP unmarkedPIR :0, 12, 17, 30</p> <p>Louvain inactiveP unmarkedPIR: 3, 4, 7, 9, 10, 14, 21, 22, 23, 26, 27, 28, 29</p> <p>Louvain inactiveP CTCFprimedE: 1, 19</p> <p>Louvain inactiveP primedE: 20, 6</p> <p>Louvain bivalentP poisedE:  18, 25</p> <p>Louvain activeP activeP: 11, 24</p> <p>Louvain activeP activeE: 8</p>"},{"location":"UMAP_representation_clustering/#em-and-louvain-clustering-comparison","title":"EM and Louvain clustering comparison","text":"![UMAP with EM clusters](./images/UMAP_EM_clusters.png){ width=\"300\" }     ![UMAO with Louvain clusters](./images/UMAP_Louvain_clusters.png){ width=\"300\" }"},{"location":"network/","title":"Network","text":"<p>Global interactions were also represented as a network largely based on the Canvas representation introduced in Chovanec, Collier et al., 2021.  The R igraph package was used to construct an undirected graph in which genomic regions (HindIII fragments) are represented as vertices/nodes and interactions are represented as edges. A combined network was produced using all significant interactions in any of the conditions. This allows for changes in interactions between the different conditions. The network was visualised with a force-directed layout (ForceAtlas2) in Gephi v0.9. This representation pulls highly interacting regions closer together while less interacting regions are kept apart.</p> <p>The underlying network data can be downloaded here.</p> <p>Layout parameters were as follows:</p> <p></p> <p>To aid visualisation of the levels of different marks, we binned the quantitations into the categories \"low\", \"medium low\", \"medium high\" and \"high\". As the different marks have different absolute levels and show different signal distributions, we categorised the data via percentiles in their empirical cumulative distribution fuction.</p> <p>Here is an example illustrating the process: The cumulative distribution of ATAC signal across different conditions is shown. There is a steady increase in signal across large parts of the data prompting us to introduce thresholds at 25, 50 and 75th percentiles.</p> <p></p> <p>Here are the thresholds for all marks:</p> mark low medium low medium high high ATAC &lt; 25 25-50 50-75 &gt;75 CTCF &lt;70 70-80 80-90 &gt;90 H3K27ac &lt;50 50-80 80-90 &gt;90 H3K27me3 &lt;50 50-80 80-90 &gt;90 H3K4me1 &lt;50 50-80 80-90 &gt; 90 H3K4me3 &lt;80 80-90 90-95 &gt;95 hmC &lt;30 30-60 60-90 &gt;90 RNA &lt;40 40-60 60-80 &gt;80 mC* &lt;25 25-50 50-75 &gt;75 <p>*Note that methylation was categorised according to absolute levels rather than percentiles as it was not measured by an enrichment method and also because the absolute levels and distributions were very different between samples:</p> <p></p>"},{"location":"software/","title":"Software","text":"<p>The following software packaged were used for processing and analysis:</p> Software Citation Bowtie2 Langmead B, et al., Nat Methods, 2012, DOI: 10.1038/nmeth.1923 Canvas Chovanec P, et al., Nat Communications, 2021, DOI: 10.1038/s41467-021-22201-4 Chicago Cairns J, et al., Genome Biology, 2016, DOI: 10.1186/s13059-016-0992-2 FastQC https://www.bioinformatics.babraham.ac.uk/projects/fastqc/ FastQScreen Wingett SW, et al., F1000Res, 2018, DOI: 10.12688/f1000research.15931.2 Gephi Bastian M., Heymann S., Jacomy M. (2009). Gephi: an open source software for exploring and manipulating networks. International AAAI Conference on Weblogs and Social Media. HICUP Wingett SW, et al., F1000Res, DOI:10.12688/f1000research.7334.1 Hisat2 Kim D, et al., Nat Biotechnology, 2019, DOI: 10.1038/s41587-019-0201-4 Igraph Csardi G, Nepusz T (2006). \u201cThe igraph software package for complex network research.\u201d InterJournal, Complex Systems, 1695. https://igraph.org. MultiQC Ewels P, et al., Bioinformatics, 2016, DOI: 10.1093/bioinformatics/btw354 R R Core Team (2021). R: A language and environment for statistical computing. R Foundation for Statistical Computing, Vienna, Austria.URL https://www.R-project.org/. Seqmonk https://www.bioinformatics.babraham.ac.uk/projects/seqmonk/ Tidyverse Wickham H, et al., Journal of Open Source Software, DOI: 10.21105/joss.01686 Trim Galore https://www.bioinformatics.babraham.ac.uk/projects/trim_galore/, latest release DOI: 10.5281/zenodo.5127899 Uwot McInnes L, et al., arXiv, 2018, DOI: 10.48550/arXiv.1802.03426 Weka Eibe Frank, Mark A. Hall, and Ian H. Witten (2016). The WEKA Workbench. Online Appendix for \"Data Mining: Practical Machine Learning Tools and Techniques\", Morgan Kaufmann, Fourth Edition, 2016."}]}